MySQL=module("vrp_mysql","MySQL")local a=module("lib/Tunnel")local b=module("lib/Proxy")vRPbkCS={}vRP=b.getInterface("vRP")vRPclient=a.getInterface("vRP","vrp_banking")vRPbkCT=a.getInterface("vrp_banking","vrp_banking")a.bindInterface("vrp_banking",vRPbkCS)MySQL.createCommand("vRP/set_code","UPDATE vrp_user_moneys SET code = @code WHERE user_id = @user_id")MySQL.createCommand("vRP/get_code","SELECT code FROM vrp_user_moneys WHERE user_id = @user_id")function vRPbkCS.atmInsert(c)local d=vRP.getUserId({source})c=tonumber(c)if c<=vRP.getMoney({d})then vRP.tryPayment({d,c})vRP.giveBankMoney({d,c})vRPclient.notify(source,'Você depositou R$ '..c)end end;function vRPbkCS.atmTake(c)local d=vRP.getUserId({source})c=tonumber(c)if c<=vRP.getBankMoney({d})then vRP.giveBankMoney({d,-c})vRP.giveMoney({d,c})vRPclient.notify(source,'Você sacou R$ '..c)end end;function vRPbkCS.atmTransfer(c,e)local d=vRP.getUserId({source})local f=vRP.getUserId({vRP.getUserSource({tonumber(e)})})if f~=nil then local c=tonumber(c)local g=vRP.getBankMoney({d})if c<=g then vRP.giveBankMoney({d,-c})vRP.giveBankMoney({f,c})vRPclient.notify(source,{'Você transferiu R$ '..c})vRPclient.notify(vRP.getUserSource({tonumber(e)}),{'Você recebeu '..c})end end end;function vRPbkCS.setAtmCode(h)MySQL.execute("vRP/set_code",{user_id=vRP.getUserId({source}),code=parseInt(h)})end;function vRPbkCS.getAtmCode(d,i)local j=Task(i)MySQL.query("vRP/get_code",{user_id=d},function(k,l)if#k>0 then j({k[1].code})end end)end
--Todos os direitos reservados a Rodrigo Lujan (Yang#6376), Copyright (C) 2018
--Discord: Yang#6376